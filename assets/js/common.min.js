jQuery(document).ready(function(t){function e(){t("#like").click(function(){var e="#like .mdl-tooltip";if("favorite"==t("#like i").html()){t("#like i").html("favorite_border"),t(e).html("赞");var i="cancel"}else t("#like i").html("favorite"),t(e).html("取消赞");t(e).css("left",t("#main").width()/2-3+"px").css("marginLeft",t(e).outerWidth()/-2+"px"),t.post(a.ajax,{action:"like",p:history.state.id,type:i},function(a){1==a.ec&&(t("#like-num").html(a.num),a.num?t("#like").removeClass("zero"):t("#like").addClass("zero"))},"json")}),t("#share").click(function(){t("#share .mdl-tooltip").removeClass("is-active")});var e=componentHandler.upgradeDom;e("MaterialTextfield"),e("MaterialButton"),e("MaterialRipple"),e("MaterialTooltip"),e("MaterialMenu")}function i(e,i){t("#page-nav").hide();var o=e.find(".t").text()+" – "+a.name;history.pushState({title:o,id:i,pos:"post"},"",a.home+"p/"+e.attr("data-pid")),t("title").text(o)}function o(a){t("html,body").animate({scrollTop:isNaN(a)?0:a},"fast")}function n(i,o){t.getJSON(a.ajax,{action:"load-comment",p:o,js:a.comment},function(t){a.comment=1,i.after(t.comment),e()})}var l="expanded",d="aria-"+l;history.replaceState({title:t("title").text(),pos:a.pos,id:id},""),t(".lv article>a").click(function(r){var s=history.state,c=+t(this).attr("id").match(/\d+/),p=t("#p"+c);s.top=t(window).scrollTop(),history.replaceState(s,""),p.hasClass(l)||(r.preventDefault(),p.attr("data-pid")?(i(p,c),n(p,c)):t.getJSON(a.ajax,{action:"load-post",p:c,js:a.comment},function(t){1==t.ec&&(i(p.attr("data-pid",t.id).append('<div class="mdl-card__content mdl-card--border">'+t.content+"</div>"),c),t.comment&&(a.comment=1,p.after(t.comment),e()))}),t("#p"+c).delay(500).show(0,function(){t("#p"+c).attr(d,"true").addClass(l),t("#primary").removeClass("lv")}).delay(500).show(0,function(){t("#t"+c+">.mdl-button__ripple-container").hide(),o()}),t("article:not(#p"+c+")").addClass("fadeout").delay(500).slideUp(500))}),t("#header-search").keydown(function(a){var e=t("#header-search").val();13==a.which&&e&&(window.location.href="?s="+e)}),t("#totop").click(o),t(window).scroll(function(){t(window).scrollTop()<99?t("#totop").fadeOut():t("#totop").fadeIn()}),e(),window.addEventListener("popstate",function(a){var e=a.state;e&&(t("title").text(e.title),"list"==e.pos?(t(".mdl-button__ripple-container,#page-nav").show(),t("#comments,#post-nav").slideUp(function(){t(this).remove()}),t("#primary").addClass("lv").delay(500).show(function(){o(e.top)}),t("article").attr(d,"false").removeClass("fadeout "+l).slideDown(500)):"post"==e.pos&&(n(t("#p"+e.id),e.id),t("article:not(#p"+e.id+")").addClass("fadeout").delay(500).show(0,function(){t("#p"+e.id).attr(d,"true").addClass(l),t("#primary").removeClass("lv")}).slideUp(500,function(){t("#t"+e.id+">.mdl-button__ripple-container,#page-nav").hide(o)})))}),t("#main").ll(),t(".lazy").ll({effect:"fadeIn"})});